(window.webpackJsonpworm=window.webpackJsonpworm||[]).push([[0],{14:function(t,i,e){},15:function(t,i,e){},16:function(t,i,e){"use strict";e.r(i);var n,o=e(2),s=e.n(o),r=e(8),a=e.n(r),h=(e(14),e(15),e(0)),c=e(1),u=e(4),d=e(3),l=e(5),v=e(6),f=function t(i,e){var n=this;Object(h.a)(this,t),this.posX=i,this.posY=e,this.positionsEqual=function(t){return n.posX===t.posX&&n.posY===t.posY}};!function(t){t[t.LEFT=37]="LEFT",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN"}(n||(n={}));var p=function(t){function i(t,e,n){var o;return Object(h.a)(this,i),(o=Object(u.a)(this,Object(d.a)(i).call(this,t,e))).color=n,o}return Object(l.a)(i,t),i}(f),w=function(){function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new f(0,0),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.DOWN,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Object(h.a)(this,t),this._headPosition=i,this._size=e,this._direction=o,this._step=s,this.body=[],this.dead=!1,this.body.push(this.headPosition)}return Object(c.a)(t,[{key:"increaseSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._size=this.size+t}},{key:"nextPosition",value:function(t){switch(t){case n.UP:return new f(this.headPosition.posX,this.headPosition.posY-this._step);case n.DOWN:return new f(this.headPosition.posX,this.headPosition.posY+this._step);case n.LEFT:return new f(this.headPosition.posX-this._step,this.headPosition.posY);case n.RIGHT:return new f(this.headPosition.posX+this._step,this.headPosition.posY);default:return console.log("no action handler for key: ",t),this.headPosition}}},{key:"checkAnotherWorm",value:function(t,i){var e=this.approachedAnotherWorm(i,t);e&&(e.dead=!0,this.increaseSize(e.size))}},{key:"approachedAnotherWorm",value:function(t,i){return t.find(function(t){return!t.headPosition.positionsEqual(i)&&!t.dead&&t.body.some(function(t){return t.positionsEqual(i)})})}},{key:"checkHimself",value:function(t){var i=this.body.some(function(i){return i.positionsEqual(new f(t.posX,t.posY-1))})&&this.body.some(function(i){return i.positionsEqual(new f(t.posX,t.posY+1))});return this.body.some(function(i){return i.positionsEqual(new f(t.posX-1,t.posY))})&&this.body.some(function(i){return i.positionsEqual(new f(t.posX+1,t.posY))})||i||this.body.some(function(i){return i.positionsEqual(t)})}},{key:"headPosition",get:function(){return this._headPosition},set:function(t){this.body.length>=this.size&&this.body.shift(),this.body.push(t),this._headPosition=t}},{key:"size",get:function(){return this._size}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction===n.DOWN&&t===n.UP||this._direction===n.UP&&t===n.DOWN||this._direction===n.LEFT&&t===n.RIGHT||this._direction===n.RIGHT&&t===n.LEFT||(this._direction=t)}},{key:"leftPositions",get:function(){var t=this.body.sort(function(t,i){return t.posX-i.posX})[0];return this.body.filter(function(i){return i.posX===t.posX})}},{key:"rightPositions",get:function(){var t=this.body.sort(function(t,i){return i.posX-t.posX})[0];return this.body.filter(function(i){return i.posX===t.posX})}}]),t}(),k=function(t){function i(){return Object(h.a)(this,i),Object(u.a)(this,Object(d.a)(i).apply(this,arguments))}return Object(l.a)(i,t),Object(c.a)(i,null,[{key:"newRandomly",value:function(t,i){for(var e=i.getRandomPosition();t.some(function(t){return t.positionsEqual(e)});)e=i.getRandomPosition();var n=e;return new this(n.posX,n.posY)}}]),i}(f),y=function(){function t(i,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3?arguments[3]:void 0;Object(h.a)(this,t),this._blockSize=n,this.ctx=o,this.size={width:0,height:0},this.size={width:i,height:e}}return Object(c.a)(t,[{key:"getRandomPosition",value:function(){return new f(Math.floor(Math.random()*this.canvasSizeInBlocks.width),Math.floor(Math.random()*this.canvasSizeInBlocks.height))}},{key:"outOfCanvas",value:function(t){return this.canvasSizeInBlocks.height<t.posY||t.posY<0||this.canvasSizeInBlocks.width<t.posX||t.posX<0}},{key:"draw",value:function(t){this.ctx.clearRect(0,0,this.size.width,this.size.height);for(var i=0;i<t.length;i++){var e=t[i];this.ctx.fillStyle=e.color,this.ctx.fillRect(e.posX*this._blockSize,e.posY*this._blockSize,this._blockSize,this._blockSize)}}},{key:"canvasSizeInBlocks",get:function(){return{width:this.size.width/this._blockSize,height:this.size.height/this._blockSize}}}]),t}(),b=function(){function t(i,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;Object(h.a)(this,t),this.fps=n,this.blockSize=o,this.intervalId=void 0,this.tick=0,this.snacks=[],this.worms=[],this.survivorMode=!1,this.canvas=void 0,this.extraDots=[],this.canvas=new y(e.width,e.height,this.blockSize,i);for(var a=0;a<s;a++)this.worms.push(new w(this.canvas.getRandomPosition()));this.initSnacks(r),this.survivorMode=s>1}return Object(c.a)(t,[{key:"initSnacks",value:function(t){for(var i=0;i<t;i++)this.snacks.push(k.newRandomly(this.worms.flatMap(function(t){return t.body}),this.canvas))}},{key:"start",value:function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.intervalId=setInterval(function(){t.run(i)},1e3/this.fps)}},{key:"stop",value:function(){this.intervalId&&clearInterval(this.intervalId)}},{key:"run",value:function(t){var i=this;this.tick++,this.worms.filter(function(t){return!t.dead}).forEach(function(e){if(t){var o=[n.DOWN,n.LEFT,n.RIGHT,n.UP];window.worm=e;var s=!1,r=n.DOWN;do{if(0===o.length){var a,h;e.dead=!0,s=!0,(a=i.extraDots).push.apply(a,Object(v.a)(e.leftPositions)),(h=i.extraDots).push.apply(h,Object(v.a)(e.rightPositions))}else{var c=Math.floor(Math.random()*o.length);r=o[c],s=i.move(e,r),o.splice(c,1)}}while(!s);e.direction=r}}),this.draw(),this.survivorMode&&this.worms.filter(function(t){return!t.dead}).length<=1&&this.stop()}},{key:"draw",value:function(){var t=[];this.worms.filter(function(t){return!t.dead}).forEach(function(i){for(var e=0;e<i.body.length;e++){var n=i.body[e],o=e===i.body.length-1?"red":i.dead?"burlywood":"black";t.push(new p(n.posX,n.posY,o))}});for(var i=0;i<this.snacks.length;i++){var e=this.snacks[i];t.push(new p(e.posX,e.posY,"green"))}this.canvas.draw(t)}},{key:"checkSnack",value:function(t,i,e){this.snacks[i].positionsEqual(e)&&(t.increaseSize(),this.snacks[i]=k.newRandomly(this.worms.flatMap(function(t){return t.body}),this.canvas))}},{key:"move",value:function(t,i){var e=t.nextPosition(i),n=this.checkNextMove(e,t);if(n){for(var o=0;o<this.snacks.length;o++)this.checkSnack(t,o,e);return t.checkAnotherWorm(e,this.worms),t.headPosition=e,n}return n}},{key:"handleKey",value:function(t){Object.values(n).includes(t)&&(this.worms[0].direction=t)}},{key:"checkNextMove",value:function(t,i){if(this.canvas.outOfCanvas(t))return!1;if(i.checkHimself(t))return!1;var e=i.approachedAnotherWorm(this.worms,t);return!e||e.size<=i.size}}]),t}(),g=function(t){function i(t){var e;return Object(h.a)(this,i),(e=Object(u.a)(this,Object(d.a)(i).call(this,t))).canvasRef=void 0,e.canvasRef=s.a.createRef(),e.state={tick:0},e}return Object(l.a)(i,t),Object(c.a)(i,[{key:"componentDidMount",value:function(){var t=this.canvasRef.current.getContext("2d");t.fillStyle="green";var i=new b(t,this.props.canvasSize,50,3,100,100);i.start(!0),window.addEventListener("keydown",function(t){return i.handleKey(t.keyCode)})}},{key:"render",value:function(){return s.a.createElement("canvas",{ref:this.canvasRef,width:this.props.canvasSize.width,height:this.props.canvasSize.height,style:{border:"1px solid"}})}}]),i}(s.a.Component),m=function(){var t=window.innerWidth-10,i=window.innerHeight-10;return s.a.createElement("div",{className:"App"},s.a.createElement(g,{canvasSize:{width:t,height:i}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(s.a.createElement(m,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},9:function(t,i,e){t.exports=e(16)}},[[9,1,2]]]);
//# sourceMappingURL=main.b96bf76b.chunk.js.map