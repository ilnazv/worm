(window.webpackJsonpworm=window.webpackJsonpworm||[]).push([[0],{14:function(t,i,e){},15:function(t,i,e){},16:function(t,i,e){"use strict";e.r(i);var n,o=e(2),s=e.n(o),a=e(8),h=e.n(a),r=(e(14),e(15),e(0)),c=e(1),u=e(5),l=e(4),d=e(6),p=e(3),f=function t(i,e){var n=this;Object(r.a)(this,t),this.posX=i,this.posY=e,this.positionsEqual=function(t){return n.posX===t.posX&&n.posY===t.posY}};!function(t){t[t.LEFT=37]="LEFT",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN"}(n||(n={}));var v=function(t){function i(t,e,n){var o;return Object(r.a)(this,i),(o=Object(u.a)(this,Object(l.a)(i).call(this,t,e))).color=n,o}return Object(d.a)(i,t),i}(f),k=function(){function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new f(0,0),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.DOWN,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Object(r.a)(this,t),this._headPosition=i,this._size=e,this._direction=o,this._step=s,this.body=[],this.dead=!1,this.body.push(this.headPosition)}return Object(c.a)(t,[{key:"increaseSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._size=this.size+t}},{key:"nextPosition",value:function(t){switch(t){case n.UP:return new f(this.headPosition.posX,this.headPosition.posY-this._step);case n.DOWN:return new f(this.headPosition.posX,this.headPosition.posY+this._step);case n.LEFT:return new f(this.headPosition.posX-this._step,this.headPosition.posY);case n.RIGHT:return new f(this.headPosition.posX+this._step,this.headPosition.posY);default:return console.log("no action handler for key: ",t),this.headPosition}}},{key:"checkAnotherWorm",value:function(t,i){var e=this.approachedAnotherWorm(i,t);e&&(e.dead=!0,this.increaseSize(e.size))}},{key:"approachedAnotherWorm",value:function(t,i){return t.find(function(t){return!t.headPosition.positionsEqual(i)&&!t.dead&&t.body.some(function(t){return t.positionsEqual(i)})})}},{key:"checkHimself",value:function(t,i){return this.body.some(function(i){return i.positionsEqual(t)})||this.pointIsInPoly(t,i)}},{key:"pointIsInPoly",value:function(t,i){var e=!1,n=Object(p.a)(this.body),o=Math.min.apply(Math,Object(p.a)(n.map(function(t){return t.posX}))),s=Math.min.apply(Math,Object(p.a)(n.map(function(t){return t.posY}))),a=Math.max.apply(Math,Object(p.a)(n.map(function(t){return t.posX}))),h=Math.max.apply(Math,Object(p.a)(n.map(function(t){return t.posY})));if(0===o)for(var r=s;r<h;r++)n.push(new f(-1,r));if(0===s)for(var c=o;c<a;c++)n.push(new f(c,-1));if(a===i.width)for(var u=s;u<h;u++)n.push(new f(i.width+1,u));if(h===i.height)for(var l=o;l<a;l++)n.push(new f(l,i.height+1));if(t.posX<o||t.posX>a||t.posY<s||t.posY>h)return!1;for(var d=0,v=n.length-1;d<n.length;v=d++)n[d].posY>t.posY!==n[v].posY>t.posY&&t.posX<(n[v].posX-n[d].posX)*(t.posY-n[d].posY)/(n[v].posY-n[d].posY)+n[d].posX&&(e=!e);return e}},{key:"headPosition",get:function(){return this._headPosition},set:function(t){this.body.length>=this.size&&this.body.shift(),this.body.push(t),this._headPosition=t}},{key:"size",get:function(){return this._size}},{key:"direction",get:function(){return this._direction},set:function(t){this._direction===n.DOWN&&t===n.UP||this._direction===n.UP&&t===n.DOWN||this._direction===n.LEFT&&t===n.RIGHT||this._direction===n.RIGHT&&t===n.LEFT||(this._direction=t)}}]),t}(),w=function(t){function i(){return Object(r.a)(this,i),Object(u.a)(this,Object(l.a)(i).apply(this,arguments))}return Object(d.a)(i,t),Object(c.a)(i,null,[{key:"newRandomly",value:function(t,i){for(var e=i.getRandomPosition();t.some(function(t){return t.positionsEqual(e)});)e=i.getRandomPosition();var n=e;return new this(n.posX,n.posY)}}]),i}(f),b=function(){function t(i,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3?arguments[3]:void 0;Object(r.a)(this,t),this._blockSize=n,this.ctx=o,this.size={width:0,height:0},this.backgroundColor="#aab9b4",this.emptyBlockColor="#8a9b93",this.size={width:i,height:e}}return Object(c.a)(t,[{key:"getRandomPosition",value:function(){return new f(Math.floor(Math.random()*this.canvasSizeInBlocks.width),Math.floor(Math.random()*this.canvasSizeInBlocks.height))}},{key:"outOfCanvas",value:function(t){return this.canvasSizeInBlocks.height<=t.posY||t.posY<0||this.canvasSizeInBlocks.width<=t.posX||t.posX<0}},{key:"draw",value:function(t){this.ctx.clearRect(0,0,this.size.width,this.size.height),this.drawEmptyBlocks();for(var i=0;i<t.length;i++){var e=t[i];this.drawBlock(e)}}},{key:"drawEmptyBlocks",value:function(){for(var t=0;t<this.canvasSizeInBlocks.width;t++)for(var i=0;i<this.canvasSizeInBlocks.height;i++)this.drawBlock(new v(t,i,this.emptyBlockColor))}},{key:"drawBlock",value:function(t){this.ctx.fillStyle=t.color,this.ctx.fillRect(t.posX*this._blockSize,t.posY*this._blockSize,this._blockSize,this._blockSize),this.ctx.fillStyle=this.backgroundColor,this.ctx.fillRect(t.posX*this._blockSize+1,t.posY*this._blockSize+1,this._blockSize-2,this._blockSize-2),this.ctx.fillStyle=t.color,this.ctx.fillRect(t.posX*this._blockSize+2,t.posY*this._blockSize+2,this._blockSize-4,this._blockSize-4)}},{key:"canvasSizeInBlocks",get:function(){return{width:Math.floor(this.size.width/this._blockSize),height:Math.floor(this.size.height/this._blockSize)}}}]),t}(),y=function(){function t(i,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;Object(r.a)(this,t),this.fps=n,this.intervalId=void 0,this.tick=0,this.snacks=[],this.worms=[],this.survivorMode=!1,this.canvas=void 0,this.extraDots=[],this.canvas=new b(e.width,e.height,e.blockSize,i);for(var a=0;a<o;a++)this.worms.push(new k(this.canvas.getRandomPosition()));this.initSnacks(s),this.survivorMode=o>1}return Object(c.a)(t,[{key:"initSnacks",value:function(t){for(var i=0;i<t;i++)this.snacks.push(w.newRandomly(this.worms.flatMap(function(t){return t.body}),this.canvas))}},{key:"start",value:function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.intervalId=setInterval(function(){t.run(i)},1e3/this.fps)}},{key:"stop",value:function(){this.intervalId&&clearInterval(this.intervalId)}},{key:"run",value:function(t){var i=this;this.tick++,this.worms.filter(function(t){return!t.dead}).forEach(function(e){if(t){var o=[n.DOWN,n.LEFT,n.RIGHT,n.UP];window.worm=e;var s=!1,a=n.DOWN;do{if(0===o.length)e.dead=!0,s=!0;else{var h=Math.floor(Math.random()*o.length);a=o[h],s=i.move(e,a),o.splice(h,1)}}while(!s);e.direction=a}}),this.draw(),this.survivorMode&&this.worms.filter(function(t){return!t.dead}).length<=1&&this.stop()}},{key:"draw",value:function(){var t=[];this.worms.filter(function(t){return!t.dead}).forEach(function(i){for(var e=0;e<i.body.length;e++){var n=i.body[e],o=i.dead?"burlywood":"black";t.push(new v(n.posX,n.posY,o))}t.push(new v(i.headPosition.posX,i.headPosition.posY,"#965050"))});for(var i=0;i<this.snacks.length;i++){var e=this.snacks[i];t.push(new v(e.posX,e.posY,"#447144"))}t.push.apply(t,Object(p.a)(this.extraDots.map(function(t){return new v(t.posX,t.posY,"blue")}))),this.canvas.draw(t)}},{key:"checkSnack",value:function(t,i,e){this.snacks[i].positionsEqual(e)&&(t.increaseSize(),this.snacks[i]=w.newRandomly(this.worms.flatMap(function(t){return t.body}),this.canvas))}},{key:"move",value:function(t,i){var e=t.nextPosition(i),n=this.checkNextMove(e,t);if(n){for(var o=0;o<this.snacks.length;o++)this.checkSnack(t,o,e);return t.checkAnotherWorm(e,this.worms),t.headPosition=e,n}return n}},{key:"handleKey",value:function(t){Object.values(n).includes(t)&&(this.worms[0].direction=t)}},{key:"checkNextMove",value:function(t,i){if(this.canvas.outOfCanvas(t))return!1;if(i.checkHimself(t,this.canvas.canvasSizeInBlocks))return!1;var e=i.approachedAnotherWorm(this.worms,t);return!e||e.size<=i.size}}]),t}(),m=function(t){function i(t){var e;return Object(r.a)(this,i),(e=Object(u.a)(this,Object(l.a)(i).call(this,t))).canvasRef=void 0,e.canvasRef=s.a.createRef(),e.state={tick:0},e}return Object(d.a)(i,t),Object(c.a)(i,[{key:"componentDidMount",value:function(){var t=this.canvasRef.current.getContext("2d"),i=new y(t,this.props.canvasSize,50,30,30);i.start(!0),window.addEventListener("keydown",function(t){return i.handleKey(t.keyCode)})}},{key:"render",value:function(){return s.a.createElement("canvas",{ref:this.canvasRef,width:this.props.canvasSize.width,height:this.props.canvasSize.height,style:{border:"1px solid"}})}}]),i}(s.a.Component),g=function(){var t=window.innerWidth-window.innerWidth%8,i=window.innerHeight-window.innerHeight%8;return s.a.createElement("div",{className:"App"},s.a.createElement(m,{canvasSize:{width:t,height:i,blockSize:8}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));h.a.render(s.a.createElement(g,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},9:function(t,i,e){t.exports=e(16)}},[[9,1,2]]]);
//# sourceMappingURL=main.f2359de8.chunk.js.map